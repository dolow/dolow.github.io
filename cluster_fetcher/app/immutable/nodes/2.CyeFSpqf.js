import{a as H,t as F,c as Ve}from"../chunks/disclose-version.C6NFzlM4.js";import{G as pe,I as ge,J as Me,e as ve,l as Be,j as $,k as Fe,i as Je,V as De,H as Ke,r as we,m as ee,n as ae,u as B,P as Ge,a8 as X,p as Te,q as qe,t as Pe,a9 as xe,aa as We,T as Xe,ab as Qe,A as Ze,L as je,X as ea,ac as aa,ad as fe,ae as ce,af as ra,s as Ee,ag as Le,ah as ta,ai as sa,N as na,aj as ia,ak as la,h as oa,al as va,am as fa,y as ca,an as ua,B as _a,ao as re,D as da,d as m,c as te,a7 as q,a5 as A,a6 as y,ap as ma,C as ye,a4 as P}from"../chunks/runtime.DV6Je3wf.js";import{d as ha,s as se}from"../chunks/render.BFG97Yj9.js";import{p as W,i as Ae}from"../chunks/if.5fgGgsDa.js";import{o as pa}from"../chunks/index-client.DcS6zYs2.js";let ke=!1;function be(){ke||(ke=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var a;if(!e.defaultPrevented)for(const r of e.target.elements)(a=r.__on_r)==null||a.call(r)})},{capture:!0}))}function ga(e){var a=Me,r=ve;pe(null),ge(null);try{return e()}finally{pe(a),ge(r)}}function wa(e,a,r,s=r){e.addEventListener(a,()=>ga(r));const n=e.__on_r;n?e.__on_r=()=>{n(),s(!0)}:e.__on_r=()=>s(!0),be()}function ne(e,a){return a}function xa(e,a,r,s){for(var n=[],l=a.length,v=0;v<l;v++)We(a[v].e,n,!0);var p=l>0&&n.length===0&&r!==null;if(p){var c=r.parentNode;Xe(c),c.append(r),s.clear(),z(e,a[0].prev,a[l-1].next)}Qe(n,()=>{for(var x=0;x<l;x++){var h=a[x];p||(s.delete(h.k),z(e,h.prev,h.next)),Ze(h.e,!p)}})}function ie(e,a,r,s,n,l=null){var v=e,p={flags:a,items:new Map,first:null},c=(a&Le)!==0;if(c){var x=e;v=$?ee(je(x)):x.appendChild(ea())}$&&Fe();var h=null,M=!1;Be(()=>{var k=r(),i=Je(k)?k:k==null?[]:De(k),f=i.length;if(M&&f===0)return;M=f===0;let _=!1;if($){var D=v.data===Ke;D!==(f===0)&&(v=we(),ee(v),ae(!1),_=!0)}if($){for(var g=null,E,w=0;w<f;w++){if(B.nodeType===8&&B.data===Ge){v=B,_=!0,ae(!1);break}var N=i[w],o=s(N,w);E=ze(B,p,g,null,N,o,w,n,a),p.items.set(o,E),g=E}f>0&&ee(we())}if(!$){var t=Me;Ea(i,p,v,n,a,(t.f&X)!==0,s)}l!==null&&(f===0?h?Te(h):h=qe(()=>l(v)):h!==null&&Pe(h,()=>{h=null})),_&&ae(!0),r()}),$&&(v=B)}function Ea(e,a,r,s,n,l,v,p){var O,J,b,Y;var c=(n&ta)!==0,x=(n&(fe|ce))!==0,h=e.length,M=a.items,k=a.first,i=k,f,_=null,D,g=[],E=[],w,N,o,t;if(c)for(t=0;t<h;t+=1)w=e[t],N=v(w,t),o=M.get(N),o!==void 0&&((O=o.a)==null||O.measure(),(D??(D=new Set)).add(o));for(t=0;t<h;t+=1){if(w=e[t],N=v(w,t),o=M.get(N),o===void 0){var u=i?i.e.nodes_start:r;_=ze(u,a,_,_===null?a.first:_.next,w,N,t,s,n),M.set(N,_),g=[],E=[],i=_.next;continue}if(x&&ya(o,w,t,n),o.e.f&X&&(Te(o.e),c&&((J=o.a)==null||J.unfix(),(D??(D=new Set)).delete(o))),o!==i){if(f!==void 0&&f.has(o)){if(g.length<E.length){var S=E[0],d;_=S.prev;var T=g[0],I=g[g.length-1];for(d=0;d<g.length;d+=1)Ne(g[d],S,r);for(d=0;d<E.length;d+=1)f.delete(E[d]);z(a,T.prev,I.next),z(a,_,T),z(a,I,S),i=S,_=I,t-=1,g=[],E=[]}else f.delete(o),Ne(o,i,r),z(a,o.prev,o.next),z(a,o,_===null?a.first:_.next),z(a,_,o),_=o;continue}for(g=[],E=[];i!==null&&i.k!==N;)(l||!(i.e.f&X))&&(f??(f=new Set)).add(i),E.push(i),i=i.next;if(i===null)continue;o=i}g.push(o),_=o,i=o.next}if(i!==null||f!==void 0){for(var L=f===void 0?[]:De(f);i!==null;)(l||!(i.e.f&X))&&L.push(i),i=i.next;var U=L.length;if(U>0){var Q=n&Le&&h===0?r:null;if(c){for(t=0;t<U;t+=1)(b=L[t].a)==null||b.measure();for(t=0;t<U;t+=1)(Y=L[t].a)==null||Y.fix()}xa(a,L,Q,M)}}c&&aa(()=>{var V;if(D!==void 0)for(o of D)(V=o.a)==null||V.apply()}),ve.first=a.first&&a.first.e,ve.last=_&&_.e}function ya(e,a,r,s){s&fe&&xe(e.v,a),s&ce?xe(e.i,r):e.i=r}function ze(e,a,r,s,n,l,v,p,c,x){var h=(c&fe)!==0,M=(c&sa)===0,k=h?M?ra(n):Ee(n):n,i=c&ce?Ee(v):v,f={i,v:k,k:l,a:null,e:null,prev:r,next:s};try{return f.e=qe(()=>p(e,k,i),$),f.e.prev=r&&r.e,f.e.next=s&&s.e,r===null?a.first=f:(r.next=f,r.e.next=f.e),s!==null&&(s.prev=f,s.e.prev=f.e),f}finally{}}function Ne(e,a,r){for(var s=e.next?e.next.e.nodes_start:r,n=a?a.e.nodes_start:r,l=e.e.nodes_start;l!==s;){var v=na(l);n.before(l),l=v}}function z(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}function Aa(e){if($){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var s=e.value;C(e,"value",null),e.value=s}if(e.hasAttribute("checked")){var n=e.checked;C(e,"checked",null),e.checked=n}}};e.__on_r=r,ia(r),be()}}function C(e,a,r,s){var n=e.__attributes??(e.__attributes={});$&&(n[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||n[a]!==(n[a]=r)&&(a==="style"&&"__styles"in e&&(e.__styles={}),a==="loading"&&(e[la]=r),r==null?e.removeAttribute(a):typeof r!="string"&&ka(e).includes(a)?e[a]=r:e.setAttribute(a,r))}var Se=new Map;function ka(e){var a=Se.get(e.nodeName);if(a)return a;Se.set(e.nodeName,a=[]);for(var r,s=e,n=Element.prototype;n!==s;){r=va(s);for(var l in r)r[l].set&&a.push(l);s=oa(s)}return a}function $e(e,a){var r=e.__className,s=Na(a);$&&e.className===s?e.__className=s:(r!==s||$&&e.className!==s)&&(a==null?e.removeAttribute("class"):e.className=s,e.__className=s)}function Na(e){return e??""}function Sa(e,a,r=a){var s=fa();wa(e,"input",n=>{var l=n?e.defaultValue:e.value;if(l=le(e)?oe(l):l,r(l),s&&l!==(l=a())){var v=e.selectionStart,p=e.selectionEnd;e.value=l??"",p!==null&&(e.selectionStart=v,e.selectionEnd=Math.min(p,e.value.length))}}),($&&e.defaultValue!==e.value||ca(a)==null&&e.value)&&r(le(e)?oe(e.value):e.value),ua(()=>{var n=a();le(e)&&n===oe(e.value)||e.type==="date"&&!n&&!e.value||n!==e.value&&(e.value=n??"")})}function le(e){var a=e.type;return a==="number"||a==="range"}function oe(e){return e===""?null:+e}var $a=(e,a)=>a(),Ma=F('<span class="date todayEvent svelte-1q0zsg4">[本日]</span>'),Da=F("<div></div>"),Ta=F('<div><div><!> <span class="date svelte-1q0zsg4"> </span></div> <img class="thumbnail svelte-1q0zsg4"> <div><span> </span></div></div> <!>',1),qa=F('<div class="userEvents svelte-1q0zsg4"><h2 class="user svelte-1q0zsg4"><a target="_blank" rel="noopener noreferrer" class="svelte-1q0zsg4"><img class="icon svelte-1q0zsg4"></a> <span><a target="_blank" rel="noopener noreferrer" class="svelte-1q0zsg4"> </a></span></h2> <div class="events svelte-1q0zsg4"></div></div>'),La=F('<div><h1>cluster の特定のユーザーのイベントだけ表示する君</h1> <div id="registerUser"><div><span>ユーザー追加</span> <input type="text" id="profileUrl" placeholder="https://cluster.mu/u/xxxxxxxx" class="svelte-1q0zsg4"> <input type="submit" id="register" value="Add"></div> <div><span class="notice svelte-1q0zsg4">プロフィールページの URL を入力してください<br> 削除する時は Cookie を削除してください</span></div></div> <!></div>');function Ha(e,a){_a(a,!0);const r="https://script.google.com/macros/s/AKfycbxL8gAUfuEE9pfJAWJrfkAFNN0tK8gdgItgSxBGJlIU0mNACEYRTetYeZ2OWkdDnsgw/exec",s="ja",n=new Date,l="usernames";let v=re(W(k())),p=re(""),c=W({}),x=re(4);async function h(){if(m(v).length===0)return;const t=`${r}?lang=${s}&${m(v).map(d=>`ids=${d}`).join("&")}`;(await(await fetch(t)).json()).forEach(d=>{const T=c[d.owner.username]||{eventSummaries:[],owner:d.owner};T.eventSummaries.push(d),c[d.owner.username]=T})}pa(()=>{(async()=>await h())();const t=[window.matchMedia("(max-width: 1024px)"),window.matchMedia("(max-width: 768px)"),window.matchMedia("(max-width: 480px)")];return t.forEach(u=>u.addEventListener("change",i)),()=>{t.forEach(u=>u.removeEventListener("change",i))}});function M(){const u=/^https:\/\/cluster\.mu\/u\/([^\/?]+)/.exec(m(p));if(u===null||u.length<=1)window.alert("URL が正しくありません");else{const S=k();S.push(u[1]),te(v,W([...new Set(S.filter(d=>d!==""))])),document.cookie=`${l}=${m(v).join(",")}`,(async()=>await h())()}}function k(){var t;return(((t=document.cookie.split("; ").find(u=>u.startsWith(`${l}=`)))==null?void 0:t.split("=")[1])||"").split(",")}function i(){te(x,W(window.matchMedia("(max-width: 480px)").matches?1:window.matchMedia("(max-width: 768px)").matches?2:window.matchMedia("(max-width: 1024px)").matches?3:4))}function f(t){return`${t.getFullYear()}/${`${t.getMonth()+1}`.padStart(2,"0")}/${`${t.getDate()}`.padStart(2,"0")} ${`${t.getHours()}`.padStart(2,"0")}:${`${t.getMinutes()}`.padStart(2,"0")}`}function _(t,u){return t.getFullYear()===u.getFullYear()&&t.getMonth()===u.getMonth()&&t.getDate()===u.getDate()}var D=La(),g=q(A(D),2),E=A(g),w=q(A(E),2);Aa(w);var N=q(w,2);N.__click=[$a,M],y(E),ma(2),y(g);var o=q(g,2);ie(o,17,()=>Object.keys(c),ne,(t,u)=>{var S=qa(),d=A(S),T=A(d),I=A(T);y(T);var L=q(T,2),U=A(L),Q=A(U,!0);y(U),y(L),y(d);var O=q(d,2);ie(O,21,()=>c[m(u)].eventSummaries,ne,(J,b,Y)=>{var V=Ta(),K=ye(V),Z=A(K),ue=A(Z);{var Ce=R=>{var G=Ma();H(R,G)};Ae(ue,R=>{_(new Date(m(b).reservation.openDatetime),n)&&R(Ce)})}var _e=q(ue,2),Ue=A(_e,!0);P(()=>se(Ue,f(new Date(m(b).reservation.openDatetime)))),y(_e),y(Z);var j=q(Z,2),de=q(j,2),me=A(de),Re=A(me,!0);y(me),y(de),y(K);var Ie=q(K,2);{var He=R=>{var G=Ve(),Oe=ye(G);ie(Oe,17,()=>[...Array(m(x)-(Y+1)%m(x))],ne,(Ye,ba)=>{var he=Da();P(()=>$e(he,`event ${`col${m(x)}`??""} empty svelte-1q0zsg4`)),H(Ye,he)}),H(R,G)};Ae(Ie,R=>{Y===c[m(u)].eventSummaries.length-1&&R(He)})}P(()=>{$e(K,`event ${`col${m(x)}`??""} svelte-1q0zsg4`),C(j,"src",m(b).thumbnailUrl),C(j,"alt",m(b).name),se(Re,m(b).name)}),H(J,V)}),y(O),y(S),P(()=>{C(T,"href",`https://cluster.mu/u/${c[m(u)].owner.username??""}/events`),C(I,"src",c[m(u)].owner.photoUrl),C(I,"alt",c[m(u)].owner.displayName),C(U,"href",`https://cluster.mu/u/${c[m(u)].owner.username??""}/events`),se(Q,c[m(u)].owner.displayName)}),H(t,S)}),y(D),Sa(w,()=>m(p),t=>te(p,t)),H(e,D),da()}ha(["click"]);export{Ha as component};
